<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>EnqueueZero Techshack 2018-52 | Enqueue Zero</title>
    <meta name="generator" content="VuePress 1.5.0">
    
    <meta name="description" content="Enqueue Zero is publishing code principles.">
    <link rel="preload" href="/assets/css/0.styles.37721fd6.css" as="style"><link rel="preload" href="/assets/js/app.0bd1d501.js" as="script"><link rel="preload" href="/assets/js/6.380ebf0c.js" as="script"><link rel="preload" href="/assets/js/138.c69379d5.js" as="script"><link rel="preload" href="/assets/js/3.6ea06ddd.js" as="script"><link rel="prefetch" href="/assets/js/1.e0c929f6.js"><link rel="prefetch" href="/assets/js/10.65c246f3.js"><link rel="prefetch" href="/assets/js/100.42bc022c.js"><link rel="prefetch" href="/assets/js/101.b5e0d1ff.js"><link rel="prefetch" href="/assets/js/102.5cd0372e.js"><link rel="prefetch" href="/assets/js/103.2f56b9a2.js"><link rel="prefetch" href="/assets/js/104.b906318a.js"><link rel="prefetch" href="/assets/js/105.1fe22608.js"><link rel="prefetch" href="/assets/js/106.2abe436c.js"><link rel="prefetch" href="/assets/js/107.6f9875d2.js"><link rel="prefetch" href="/assets/js/108.7e984ecf.js"><link rel="prefetch" href="/assets/js/109.e0004694.js"><link rel="prefetch" href="/assets/js/11.87112945.js"><link rel="prefetch" href="/assets/js/110.b2b6620a.js"><link rel="prefetch" href="/assets/js/111.b48f79e5.js"><link rel="prefetch" href="/assets/js/112.466e709c.js"><link rel="prefetch" href="/assets/js/113.208a2737.js"><link rel="prefetch" href="/assets/js/114.227a0d44.js"><link rel="prefetch" href="/assets/js/115.179d320d.js"><link rel="prefetch" href="/assets/js/116.e552502b.js"><link rel="prefetch" href="/assets/js/117.8be14f3a.js"><link rel="prefetch" href="/assets/js/118.fa87138a.js"><link rel="prefetch" href="/assets/js/119.e37d33d8.js"><link rel="prefetch" href="/assets/js/12.3194c411.js"><link rel="prefetch" href="/assets/js/120.e8e10f61.js"><link rel="prefetch" href="/assets/js/121.1df6fca0.js"><link rel="prefetch" href="/assets/js/122.25ba9a0f.js"><link rel="prefetch" href="/assets/js/123.622ec346.js"><link rel="prefetch" href="/assets/js/124.c5bc3c03.js"><link rel="prefetch" href="/assets/js/125.7dbdf891.js"><link rel="prefetch" href="/assets/js/126.8342f743.js"><link rel="prefetch" href="/assets/js/127.469cfcfa.js"><link rel="prefetch" href="/assets/js/128.0cd9c417.js"><link rel="prefetch" href="/assets/js/129.2ac6abf9.js"><link rel="prefetch" href="/assets/js/13.aa511a98.js"><link rel="prefetch" href="/assets/js/130.13b3a85d.js"><link rel="prefetch" href="/assets/js/131.6a4e1940.js"><link rel="prefetch" href="/assets/js/132.a27cb358.js"><link rel="prefetch" href="/assets/js/133.9ed6a0a7.js"><link rel="prefetch" href="/assets/js/134.26978afb.js"><link rel="prefetch" href="/assets/js/135.85848719.js"><link rel="prefetch" href="/assets/js/136.a68d5df6.js"><link rel="prefetch" href="/assets/js/137.fe371a92.js"><link rel="prefetch" href="/assets/js/139.348e1646.js"><link rel="prefetch" href="/assets/js/14.606d1bea.js"><link rel="prefetch" href="/assets/js/140.3e55afd9.js"><link rel="prefetch" href="/assets/js/141.c522d5bd.js"><link rel="prefetch" href="/assets/js/142.a24a3554.js"><link rel="prefetch" href="/assets/js/143.682b1ac6.js"><link rel="prefetch" href="/assets/js/144.70a59945.js"><link rel="prefetch" href="/assets/js/145.3f37c0df.js"><link rel="prefetch" href="/assets/js/146.ffcc6e57.js"><link rel="prefetch" href="/assets/js/147.759cfc52.js"><link rel="prefetch" href="/assets/js/148.7c30376b.js"><link rel="prefetch" href="/assets/js/149.f7f4ee86.js"><link rel="prefetch" href="/assets/js/15.8a347078.js"><link rel="prefetch" href="/assets/js/150.f469ab8b.js"><link rel="prefetch" href="/assets/js/151.1a435d23.js"><link rel="prefetch" href="/assets/js/152.53447eda.js"><link rel="prefetch" href="/assets/js/153.c6e576ce.js"><link rel="prefetch" href="/assets/js/154.7bd19cc0.js"><link rel="prefetch" href="/assets/js/155.57ede3e1.js"><link rel="prefetch" href="/assets/js/156.94f1bbcb.js"><link rel="prefetch" href="/assets/js/157.00739681.js"><link rel="prefetch" href="/assets/js/158.7e5823cf.js"><link rel="prefetch" href="/assets/js/159.cec7d8d9.js"><link rel="prefetch" href="/assets/js/16.0f6060a6.js"><link rel="prefetch" href="/assets/js/160.985decbf.js"><link rel="prefetch" href="/assets/js/161.ed1f6fff.js"><link rel="prefetch" href="/assets/js/17.8a8db3f8.js"><link rel="prefetch" href="/assets/js/18.c1c32db5.js"><link rel="prefetch" href="/assets/js/19.d86bf541.js"><link rel="prefetch" href="/assets/js/2.d451d784.js"><link rel="prefetch" href="/assets/js/20.761042d8.js"><link rel="prefetch" href="/assets/js/21.989f5a9d.js"><link rel="prefetch" href="/assets/js/22.ddfd889e.js"><link rel="prefetch" href="/assets/js/23.954d5189.js"><link rel="prefetch" href="/assets/js/24.c61f517c.js"><link rel="prefetch" href="/assets/js/25.80a01328.js"><link rel="prefetch" href="/assets/js/26.fd330669.js"><link rel="prefetch" href="/assets/js/27.0a33f2cb.js"><link rel="prefetch" href="/assets/js/28.e21d5b88.js"><link rel="prefetch" href="/assets/js/29.12412ca6.js"><link rel="prefetch" href="/assets/js/30.5b7db60c.js"><link rel="prefetch" href="/assets/js/31.654806be.js"><link rel="prefetch" href="/assets/js/32.c74b419d.js"><link rel="prefetch" href="/assets/js/33.db58ad63.js"><link rel="prefetch" href="/assets/js/34.02b06862.js"><link rel="prefetch" href="/assets/js/35.f144b75a.js"><link rel="prefetch" href="/assets/js/36.47387362.js"><link rel="prefetch" href="/assets/js/37.9db4d157.js"><link rel="prefetch" href="/assets/js/38.2fc02702.js"><link rel="prefetch" href="/assets/js/39.1dfc6a6c.js"><link rel="prefetch" href="/assets/js/4.1b578b6a.js"><link rel="prefetch" href="/assets/js/40.b6cdd33b.js"><link rel="prefetch" href="/assets/js/41.0ba34ce5.js"><link rel="prefetch" href="/assets/js/42.18b55462.js"><link rel="prefetch" href="/assets/js/43.e619a537.js"><link rel="prefetch" href="/assets/js/44.4bf91d97.js"><link rel="prefetch" href="/assets/js/45.292c54fe.js"><link rel="prefetch" href="/assets/js/46.359760e9.js"><link rel="prefetch" href="/assets/js/47.6f95684b.js"><link rel="prefetch" href="/assets/js/48.a43b234f.js"><link rel="prefetch" href="/assets/js/49.bab06cb1.js"><link rel="prefetch" href="/assets/js/50.7e676799.js"><link rel="prefetch" href="/assets/js/51.8ee22d62.js"><link rel="prefetch" href="/assets/js/52.cfb7ce7a.js"><link rel="prefetch" href="/assets/js/53.05490146.js"><link rel="prefetch" href="/assets/js/54.6f230790.js"><link rel="prefetch" href="/assets/js/55.e84add2b.js"><link rel="prefetch" href="/assets/js/56.4714565c.js"><link rel="prefetch" href="/assets/js/57.7b57b5f4.js"><link rel="prefetch" href="/assets/js/58.728d8184.js"><link rel="prefetch" href="/assets/js/59.78ebb42e.js"><link rel="prefetch" href="/assets/js/60.400d133e.js"><link rel="prefetch" href="/assets/js/61.394cc671.js"><link rel="prefetch" href="/assets/js/62.b33ca5fc.js"><link rel="prefetch" href="/assets/js/63.3d15725e.js"><link rel="prefetch" href="/assets/js/64.76825203.js"><link rel="prefetch" href="/assets/js/65.c868ff2e.js"><link rel="prefetch" href="/assets/js/66.80d45b6f.js"><link rel="prefetch" href="/assets/js/67.7eae91af.js"><link rel="prefetch" href="/assets/js/68.06a2d949.js"><link rel="prefetch" href="/assets/js/69.6355d227.js"><link rel="prefetch" href="/assets/js/7.6ecfe519.js"><link rel="prefetch" href="/assets/js/70.ff5e753b.js"><link rel="prefetch" href="/assets/js/71.f8e194e0.js"><link rel="prefetch" href="/assets/js/72.ea4d8f53.js"><link rel="prefetch" href="/assets/js/73.b5a5c5eb.js"><link rel="prefetch" href="/assets/js/74.ac1861f3.js"><link rel="prefetch" href="/assets/js/75.3e34dc1f.js"><link rel="prefetch" href="/assets/js/76.814bbe49.js"><link rel="prefetch" href="/assets/js/77.079e4dd1.js"><link rel="prefetch" href="/assets/js/78.3ccb46ac.js"><link rel="prefetch" href="/assets/js/79.d632088a.js"><link rel="prefetch" href="/assets/js/8.222ab8c9.js"><link rel="prefetch" href="/assets/js/80.7d8d7cb1.js"><link rel="prefetch" href="/assets/js/81.f147634a.js"><link rel="prefetch" href="/assets/js/82.dc6f855d.js"><link rel="prefetch" href="/assets/js/83.b90ba4db.js"><link rel="prefetch" href="/assets/js/84.765f864d.js"><link rel="prefetch" href="/assets/js/85.6e178f6d.js"><link rel="prefetch" href="/assets/js/86.2cd36f35.js"><link rel="prefetch" href="/assets/js/87.4d9e7568.js"><link rel="prefetch" href="/assets/js/88.061b8473.js"><link rel="prefetch" href="/assets/js/89.8d715627.js"><link rel="prefetch" href="/assets/js/9.334faa1a.js"><link rel="prefetch" href="/assets/js/90.9b330d8e.js"><link rel="prefetch" href="/assets/js/91.1e7d6010.js"><link rel="prefetch" href="/assets/js/92.612b2e49.js"><link rel="prefetch" href="/assets/js/93.6ee43dc4.js"><link rel="prefetch" href="/assets/js/94.e73a2469.js"><link rel="prefetch" href="/assets/js/95.dbbc0dad.js"><link rel="prefetch" href="/assets/js/96.dd16c729.js"><link rel="prefetch" href="/assets/js/97.cc5c3f8c.js"><link rel="prefetch" href="/assets/js/98.cbd15221.js"><link rel="prefetch" href="/assets/js/99.c7e7a198.js">
    <link rel="stylesheet" href="/assets/css/0.styles.37721fd6.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Enqueue Zero</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/soasme/enqueuezero" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/soasme/enqueuezero" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>EnqueueZero Techshack 2018-52</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/techshack.weekly/2018-52.html#dns-load-balancing-in-cloud-era" class="sidebar-link">DNS Load Balancing in Cloud-era</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/techshack.weekly/2018-52.html#envoy-proxy-at-reddit" class="sidebar-link">Envoy Proxy at Reddit</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/techshack.weekly/2018-52.html#clojure-s-stability-lessons-learned" class="sidebar-link">Clojureâ€™s stability: lessons learned</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/techshack.weekly/2018-52.html#why-you-should-be-using-pathlib" class="sidebar-link">Why you should be using pathlib</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/techshack.weekly/2018-52.html#top-20-dev-tools-for-2019" class="sidebar-link">Top 20 Dev Tools for 2019</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/techshack.weekly/2018-52.html#designing-resilient-systems-circuit-breakers-or-retries-part-1" class="sidebar-link">Designing resilient systems: Circuit Breakers or Retries? (Part 1)</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/techshack.weekly/2018-52.html#achieving-resiliency-with-queues-building-a-system-that-never-skips-a-beat-in-a-billion" class="sidebar-link">Achieving Resiliency With Queues: Building A System That Never Skips A Beat In A Billion</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/techshack.weekly/2018-52.html#applied-machine-learning-at-facebook-a-datacenter-infrastructure-perspective" class="sidebar-link">Applied Machine Learning at Facebook: A Datacenter Infrastructure Perspective</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/techshack.weekly/2018-52.html#identifying-impactful-service-system-problems-via-log-analysis" class="sidebar-link">Identifying impactful service system problems via log analysis</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/techshack.weekly/2018-52.html#space-shuttle-style-kubernetes" class="sidebar-link">Space Shuttle Style (Kubernetes)</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="enqueuezero-techshack-2018-52"><a href="#enqueuezero-techshack-2018-52" class="header-anchor">#</a> EnqueueZero Techshack 2018-52</h1> <div class="techshack-header"><p>Kia ora! I am the creator of <strong>Enqueue Zero</strong> (<a href="https://enqueuezero.com">https://enqueuezero.com</a>), a site that explains code principles to Developers/DevOps/Sysadmins. This site is updated under a single man team since 2018. The `EnqueueZero Techshack` series is comprised of a bunch of interesting posts I wrote or found on the Internet. More importantly, I hope these posts would please you.</p><p></p><div><p>
      Please follow Twitter account <a href="https://twitter.com/enqueuezero">@enqueuezero</a> for the updates.  Happy exploring!
    </p></div></div> <h2 id="dns-load-balancing-in-cloud-era"><a href="#dns-load-balancing-in-cloud-era" class="header-anchor">#</a> DNS Load Balancing in Cloud-era</h2> <p><a href="https://enqueuezero.com/dns-load-balancing.html" target="_blank" rel="noopener noreferrer">enqueuezero.com<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>DNS load balancing distributes requests across multiple IP addresses by configuring various DNS A records. Modern tools enable programmatically updating DNS records. When the incident happens, some of them can even automatically update the DNS records. The downside of DNS load balancing is that it cannot distribute requests evenly to the backend servers.</p> <h2 id="envoy-proxy-at-reddit"><a href="#envoy-proxy-at-reddit" class="header-anchor">#</a> Envoy Proxy at Reddit</h2> <p><a href="https://redditblog.com/2018/12/18/envoy-proxy-at-reddit/" target="_blank" rel="noopener noreferrer">redditblog.com<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>This post discusses the usage of Envoy Proxy at Reddit in order to reduce the complexity of services interacting with each other. In particular, Envoy, as a replacement of Airbnb <a href="https://medium.com/airbnb-engineering/smartstack-service-discovery-in-the-cloud-4b8a080de619" target="_blank" rel="noopener noreferrer">SmartStack<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> is a Service-to-Service L4/L7 Proxy.</p> <p>Migrating to the new system is not easy work, and hence it's a step by step improving. Reddit currently mixes using SmartStack(Synapse, HAProxy, Nervel) and Envoy - it still uses Nerve and Synapse to handle service registration and discovery and uses Envoy for basic TCP proxying.</p> <img alt="Envoy Proxy at Reddit" src="https://redditupvoted.files.wordpress.com/2018/12/Screen-Shot-2018-12-14-at-11.13.22-AM.png" style="height:20rem;"> <p>Let's see how the system eventually ends later. ðŸ˜ƒ</p> <h2 id="clojure-s-stability-lessons-learned"><a href="#clojure-s-stability-lessons-learned" class="header-anchor">#</a> Clojureâ€™s stability: lessons learned</h2> <p>Aka, why is clojure so stable?</p> <p><a href="https://words.steveklabnik.com/why-is-clojure-so-stable" target="_blank" rel="noopener noreferrer">words.steveklabnik.com<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>Clojure has a well-deserved reputation for stability.</p> <ul><li>Rich, the <a href="https://en.wikipedia.org/wiki/Benevolent_dictator_for_life" target="_blank" rel="noopener noreferrer">BDFL<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> or Benevolent dictator for life, deserves a lot of credit.</li> <li>Clojure as a Lisp dialect is lack of syntax, and thus rarely grows syntactically. New syntaxes are introduced through macros.</li> <li>Clojure is dynamically typed - it can be easier to change a dynamic system than a static one.</li> <li>Clojure development is slow - Itâ€™s much easier to keep things stable when you donâ€™t change as often.</li></ul> <h2 id="why-you-should-be-using-pathlib"><a href="#why-you-should-be-using-pathlib" class="header-anchor">#</a> Why you should be using pathlib</h2> <p><a href="https://treyhunner.com/2018/12/why-you-should-be-using-pathlib/" target="_blank" rel="noopener noreferrer">treyhunner.com<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>Since Python 3.6, you're able to use pathlib instead of os-family utilities. Some of the best designed APIs are listed below.</p> <div class="language-python extra-class"><pre class="language-python"><code>Path<span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span>content<span class="token punctuation">)</span>

Path<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">.</span>parent<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>join_path<span class="token punctuation">(</span>resource_filename<span class="token punctuation">)</span>

Path<span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span>parents<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> exist_ok<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

Path<span class="token punctuation">(</span>filename1<span class="token punctuation">)</span><span class="token punctuation">.</span>rename<span class="token punctuation">(</span>filename2<span class="token punctuation">)</span>

Path<span class="token punctuation">.</span>cwd<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>glob<span class="token punctuation">(</span><span class="token string">'*.csv'</span><span class="token punctuation">)</span>

<span class="token punctuation">[</span>p<span class="token punctuation">.</span>read_text<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">for</span> p <span class="token keyword">in</span> Path<span class="token punctuation">.</span>cwd<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>rglob<span class="token punctuation">(</span><span class="token string">'*.csv'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
</code></pre></div><h2 id="top-20-dev-tools-for-2019"><a href="#top-20-dev-tools-for-2019" class="header-anchor">#</a> Top 20 Dev Tools for 2019</h2> <p><a href="https://blog.axosoft.com/top-developer-tools-2019/" target="_blank" rel="noopener noreferrer">blog.axosoft.com<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>They're GitKaren, VSCode, Docker, Git, Postman, VStudio, ChromeDevTools, GitLab, SublimeText, IntelliJ IDEA, GitHub, Slack, Atom, Azure, Trello, Google, XCode, Eclipse IDE, Linux.</p> <h2 id="designing-resilient-systems-circuit-breakers-or-retries-part-1"><a href="#designing-resilient-systems-circuit-breakers-or-retries-part-1" class="header-anchor">#</a> Designing resilient systems: Circuit Breakers or Retries? (Part 1)</h2> <p><a href="https://engineering.grab.com/designing-resilient-systems-part-1" target="_blank" rel="noopener noreferrer">engineering.grab.com<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>This article focuses on the use cases for implementing circuit breakers including the different options related to the configuration of circuits. As long as your service communicates with external resources, failures can be caused by:</p> <ul><li>networking issues</li> <li>system overload</li> <li>resource starvation (e.g. out of memory)</li> <li>bad deployment/configuration</li> <li>bad request (e.g. lack of authentication credentials, missing request data)</li></ul> <p>Meanwhile, a success request should be timely, in the expected format, and contain the expected data, and  everything else is therefore some kind of failure(from client perspective), whether itâ€™s:</p> <ul><li>a slow response</li> <li>no response at all</li> <li>a response in the wrong format</li> <li>a response that does not contain the expected data</li></ul> <p>And hence We should only track errors by the network or infrastructure (i.e. HTTP error codes 503 and 500). After circuit breaker opens, no requests go to the external service. After the Sleep Window, it either keeps itself open or recovers itself.</p> <p>So when setting Circuit Breaker, keep 5 things in mind:</p> <ul><li>Timeout - the maximum amount of time a request is allowed to take before being considered an error.</li> <li>Max Concurrent Requests (Bulwark) - to prevent more than the configured maximum number of concurrent requests from being made.</li> <li>Request Volume Threshold - the minimum number of requests that must be made within the evaluation (rolling window) period before the circuit can be opened.</li> <li>Sleep Window - the duration the circuit waits before the circuit breaker will attempt to check the health of the requests</li> <li>Error Percent Threshold - the percentage of requests that must fail before the circuit is opened.</li></ul> <p>Setting circuit breaker per service has a downside - it cannot detect errors caused by one bad instance. In comparison, setting circuit breaker per host is better, though it increases the complexity.</p> <h2 id="achieving-resiliency-with-queues-building-a-system-that-never-skips-a-beat-in-a-billion"><a href="#achieving-resiliency-with-queues-building-a-system-that-never-skips-a-beat-in-a-billion" class="header-anchor">#</a> Achieving Resiliency With Queues: Building A System That Never Skips A Beat In A Billion</h2> <p><a href="https://www.braze.com/perspectives/article/building-braze-job-queues-resiliency" target="_blank" rel="noopener noreferrer">www.braze.com<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>This article discusses a set of techniques applying to Job Queues.</p> <ul><li>Launch multiple sets of queues and workers.</li> <li>Save jobs to the database and send to the queue. If failed sending, retry.</li> <li>Pause certain queues if needed.</li> <li>Create queues for certain campaigns having a large amount of jobs to avoid job starvation.</li> <li>If the queue platform is experiencing errors, client-side retry with an exponential backoff algorithm until it succeeds.</li></ul> <h2 id="applied-machine-learning-at-facebook-a-datacenter-infrastructure-perspective"><a href="#applied-machine-learning-at-facebook-a-datacenter-infrastructure-perspective" class="header-anchor">#</a> Applied Machine Learning at Facebook: A Datacenter Infrastructure Perspective</h2> <p><a href="https://research.fb.com/publications/applied-machine-learning-at-facebook-a-datacenter-infrastructure-perspective/" target="_blank" rel="noopener noreferrer">research.fb.com<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>The paper describes how Facebook applies ML to its services.</p> <ul><li>Machine learning is applied pervasively across nearly all services.</li> <li>Facebook funnels a large fraction of all stored data through machine learning pipelines, and this fraction is increasing over time to improve model quality.</li> <li>Some of the most important ML algorithms at Facebook include logistic regression, SVM, gradient boosted decision trees, and DNNs(MLPs for structured data, CNNs for spatial tasks, RNN/LSTMs for sequence processing)</li> <li>Examples
<ul><li>Multi-Layer Perceptron(MLPs).
<ul><li>Ranking of stories in the News Feed.</li> <li>Ads display to a given user.</li> <li>Search on photos, videos, etc.</li></ul></li> <li>Gradient Boosted Decision Trees(GBDT).
<ul><li>General classification and anomaly detection.</li></ul></li> <li>Support Vector Machines(SVM).
<ul><li>Face detection.</li></ul></li> <li>Recurrent Neural Networks (RNN)
<ul><li>Translations, Speech Recognition.</li></ul></li></ul></li> <li>Facebook's internal tools include FBLearner, PyTorch, Caffe2.</li> <li>Facebook uses <a href="https://onnx.ai/" target="_blank" rel="noopener noreferrer">ONNX<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> for exchanging models from PyTorch to production environment Caffe2.</li></ul> <h2 id="identifying-impactful-service-system-problems-via-log-analysis"><a href="#identifying-impactful-service-system-problems-via-log-analysis" class="header-anchor">#</a> Identifying impactful service system problems via log analysis</h2> <p><a href="https://dl.acm.org/citation.cfm?id=3236083" target="_blank" rel="noopener noreferrer">dl.acm.org<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> | <a href="https://github.com/logpai/Log3C" target="_blank" rel="noopener noreferrer">GitHub Project<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> | <a href="https://blog.acolyer.org/2018/12/19/identifying-impactful-service-system-problems-via-log-analysis/" target="_blank" rel="noopener noreferrer">the morning paper<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>A distributed version of Log3C has been deployed and served in Microsoft Production for years, analyzing tens of billions of log messages every day. It's a log-based impactful problem identification using machine learning at Microsoft.</p> <p>It takes below steps from raw log records to problems.</p> <p><img src="https://enqueuezero.com/static/images/2018-52-log3c.jpeg" alt="Log3C"></p> <ol><li>Log parsing. De-parametrize the raw log records into a sequence of events. Eventually, each log sequence becomes a vector - n different types of events is equal to the n-element vector.</li></ol> <div class="language- extra-class"><pre class="language-text"><code>HTTP Request URL: /path

=&gt;

Event: &quot;HTTP Request URL: *&quot;

=&gt;

[E1, ]
</code></pre></div><ol start="2"><li>Sequence Vectorization. Chunk events into a configured time interval and get the weight of each event. Inverse Document Frequency(IDF) weights are normalized into the range [0, 1] using the sigmoid function.</li></ol> <div class="language- extra-class"><pre class="language-text"><code>[t1, E1]
[t1, E2]
[t2, E1]
[t2, E2]
[t2, E2]

=&gt;
   E1  E2
t1 [1, 1]
t2 [1, 2]
</code></pre></div><ol start="3"><li><p>Cascading Clustering. Group the events in the same category. Each iteration goes through sampling, clustering, matching.</p></li> <li><p>Correlation Analysis. Correlate clusters with changes to KPIs.</p></li></ol> <h2 id="space-shuttle-style-kubernetes"><a href="#space-shuttle-style-kubernetes" class="header-anchor">#</a> Space Shuttle Style (Kubernetes)</h2> <p><a href="https://github.com/kubernetes/kubernetes/blob/ec2e767e59395376fa191d7c56a74f53936b7653/pkg/controller/volume/persistentvolume/pv_controller.go" target="_blank" rel="noopener noreferrer">github.com<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>The code style of Kubernetes PersistentVolume code is so-called <code>space shuttle style</code> which is used in NASA space shuttle applications. The ideas are:</p> <ul><li>Every 'if' statement has a matching 'else'
<ul><li>except for simple error checks for a client API call</li></ul></li> <li>Things that may seem obvious are commented explicitly</li></ul> <p>It can be in below two styles.</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token comment">// Try to do what?</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>cond<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// true logic</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  <span class="token comment">// false logic</span>
<span class="token punctuation">}</span>

<span class="token comment">// Try to do what?</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>cond<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// false logic</span>
<span class="token punctuation">}</span>
<span class="token comment">// true logic</span>
</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/soasme/enqueuezero/edit/master/techshack.weekly/2018-52.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.0bd1d501.js" defer></script><script src="/assets/js/6.380ebf0c.js" defer></script><script src="/assets/js/138.c69379d5.js" defer></script><script src="/assets/js/3.6ea06ddd.js" defer></script>
  </body>
</html>
